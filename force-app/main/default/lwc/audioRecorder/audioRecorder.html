<template>
	<div class="audio-recorder">
		<div class="device-selection">
			<label for="audioDevices">Select Microphone:</label>
			<select
				id="audioDevices"
				class="audio-device-select"
				onchange={handleDeviceChange}
				disabled={isRecording}
			>
				<option value="">Select a microphone...</option>
				<template for:each={audioDevices} for:item="device">
					<option key={device.deviceId} value={device.deviceId}>
						{device.label}
					</option>
				</template>
			</select>
		</div>

		<div class="controls">
			<button
				class="record-button"
				onclick={initializeRecording}
				disabled={micInitialized}
			>
				Initialize Microphone
			</button>

			<button
				class="record-button"
				onclick={startRecording}
				disabled={notRecording}
			>
				{recordButtonLabel}
			</button>

			<button
				class="stop-button"
				onclick={stopRecording}
				disabled={stopButtonDisabled}
			>
				Stop Recording
			</button>
		</div>

		<div class="audio-monitor" if:true={isRecording}>
			<canvas class="visualizer" lwc:dom="manual"></canvas>
		</div>

		<div class="conversation-container">
			<template if:true={transcripts.length}>
				<div class="transcripts">
					<template for:each={transcripts} for:item="transcript">
						<div key={transcript.id} class="transcript-bubble">
							{transcript.text}
						</div>
					</template>
				</div>
			</template>
		</div>
	</div>
</template>
